<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Music Party Chooser</title>
    <link rel="shortcut icon" type="image/png" href="favicon.png" />
    <link href="https://fonts.googleapis.com/css?family=Monoton|Roboto:100&display=swap" rel="stylesheet">

    <style>
        @import url("./styles/parties.css");
    </style>
</head>

<body>
    <div class="responsive-parties">
        <div id="mySidenav" class="sidenav">
            <a href="javascript:void(0)" class="close" onclick="closeNav()">&times;</a>
            <img src="./images/logo_transparent.png" id="logo">
            <a href="parties.html">Parties nearby</a>
            <a href="myparties.html">My Parties</a>
            <a href="party.html">Current party</a>
            <a href="settings.html">Settings</a>
            <a href="statistics.html">Statistics</a>
            <a href="#">Log out</a>
        </div>
        <div class="parties">
            <span class="menu" onclick="openNav()">&#9776;</span>
            <p class="title">Parties nearby</p>
            <div class="party-cards" id="parties">
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019 </p>
                        <p style="color:white;">Starts at: 21:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
                <div class="card">
                    <div class="container">
                        <p>Party: fffff</p>
                        <p>Organizer: Liidid</p>
                        <p>Location : Str. llslldg </p>
                        <p style="color:white;">Date : 14/12/2019</p>
                        <p style="color:white;">Starts at : 20:00</p>
                    </div>
                    <div class="button_container">
                        <button class="btn"><span>Attend</span></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script src="js/ui.js"></script>
<script>
var wrapper=document.getElementById('parties');
document.addEventListener("DOMContentLoaded",getData);
let token = window.localStorage.getItem('userToken');
console.log(token)
function getData(){
    fetch("http://localhost:5000/event/get-parties",{
        method:'GET',
        headers:  {
            'Accept': '*/*',
            'Content-Type': 'application/json',
            'Authorization':'Bearer ' + token
           
        }
    })
   .then(response =>response.json())
   .then(Respjson=>{
       for(i in Respjson.party){
           var card=document.createElement('div');
           card.className='card';
           var container=document.createElement('div');
           container.className='container';
           var pName=document.createElement('p');
           pName.innerText='Party : '+Respjson.party[i].nume;
           var latitude=Respjson.party[i].latitudine;
           var longitudine= Respjson.party[i].longitudine;
           console.log(latitude);
           console.log(longitudine);
           var apiKey='466c09a776ed417b8ace9ad07c6527d9' 
           fetch('https://api.opencagedata.com/geocode/v1/json?q='+latitude+"%2C"+longitudine+'&key=466c09a776ed417b8ace9ad07c6527d9')
           .then(res=>res.json())
           .then(response=>{
            console.log(response.results[0].formatted);
           })
           console.log(Respjson.party[i].nume)
       }
   })
}

</script>
</html>